CREATE TABLE `hg_finance_code` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `code` varchar(20) NOT NULL COMMENT '代码',
  `name` varchar(150) DEFAULT NULL COMMENT '名称',
  `exchange` varchar(10) DEFAULT '' COMMENT '交易所',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5177 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='股票代码';


CREATE TABLE `hg_finance_code_daily` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `code` varchar(20) NOT NULL COMMENT '代码',
  `name` varchar(150) DEFAULT NULL COMMENT '名称',
  `exchange` varchar(10) DEFAULT '' COMMENT '交易所',
  `day` varchar(20) DEFAULT NULL COMMENT '日期',
  `timestamp` bigint DEFAULT NULL COMMENT '时间戳',
  `status` tinyint DEFAULT '0' COMMENT '0未开始 1完成 -1失败',
  PRIMARY KEY (`id`),
  KEY `idx_status` (`status`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=24193 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='股票代码_每日任务执行';

CREATE TABLE `hg_finance_kline` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `code` varchar(20) DEFAULT '' COMMENT 'code',
  `kline_type` tinyint DEFAULT '0' COMMENT 'k线类型',
  `timestamp` bigint DEFAULT NULL COMMENT '时间戳',
  `open_price` float DEFAULT NULL COMMENT '该K线开盘价',
  `close_price` float DEFAULT NULL COMMENT '该K线收盘价',
  `high_price` float DEFAULT NULL COMMENT '该K线最高价',
  `low_price` float DEFAULT NULL COMMENT '该K线最低价',
  `volume` bigint DEFAULT NULL COMMENT '该K线成交数量',
  `turnover` float DEFAULT NULL COMMENT '该K线成交金额',
  `created_at` datetime DEFAULT NULL COMMENT '创建时间',
  `key` varchar(100) NOT NULL COMMENT '唯一key，timestamp和code组合',
  `scale` int NOT NULL COMMENT '多少分钟一根K线',
  `day` varchar(50) DEFAULT NULL COMMENT '日期',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uidx_key` (`key`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=43136 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='k线';

CREATE TABLE `hg_finance_boll` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `code` varchar(20) DEFAULT '' COMMENT 'code',
  `kline_id` bigint DEFAULT NULL COMMENT 'k线id',
  `kline_type` tinyint DEFAULT '0' COMMENT 'k线类型',
  `timestamp` bigint DEFAULT NULL COMMENT '时间戳',
  `middle_band` float DEFAULT NULL COMMENT '中轨（移动平均线）',
  `upper_band` float DEFAULT NULL COMMENT '上轨',
  `lower_band` float DEFAULT NULL COMMENT '下轨',
  `standard_deviation` float DEFAULT NULL COMMENT '标准差',
  `close_price` float DEFAULT NULL COMMENT '收盘价',
  `kline_num` int DEFAULT '20' COMMENT 'k线根数',
  `multiple` int DEFAULT '2' COMMENT '标准差倍数',
  `created_at` datetime DEFAULT NULL COMMENT '创建时间',
  `key` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL COMMENT 'timestamp和code组合',
  `day` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL COMMENT '日期',
  `scale` int DEFAULT NULL COMMENT '分钟一条k线',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uidx_key` (`key`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=140 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='boll带';


CREATE TABLE `hg_finance_daily_kline` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `code` varchar(20) DEFAULT '' COMMENT '股票代码',
  `kline_type` tinyint DEFAULT '0' COMMENT 'K线类型: 0-普通 1-复权',
  `timestamp` bigint DEFAULT NULL COMMENT '时间戳',
  `open_price` decimal(10,4) DEFAULT NULL COMMENT '开盘价',
  `close_price` decimal(10,4) DEFAULT NULL COMMENT '收盘价',
  `high_price` decimal(10,4) DEFAULT NULL COMMENT '最高价',
  `low_price` decimal(10,4) DEFAULT NULL COMMENT '最低价',
  `volume` bigint DEFAULT NULL COMMENT '成交量',
  `turnover` decimal(15,4) DEFAULT NULL COMMENT '成交额',
  `md_5` decimal(10,4) COMMENT '5日均线',
  `md_10` decimal(10,4) COMMENT '10日均线',
  `md_20` decimal(10,4) COMMENT '20日均线',
  `md_30` decimal(10,4) COMMENT '30日均线',
  `md_60` decimal(10,4) COMMENT '60日均线',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `unique_key` varchar(100) NOT NULL COMMENT '唯一键: timestamp_code_scale',
  `scale` int NOT NULL COMMENT 'K线周期(分钟)',
  `day` varchar(50) DEFAULT NULL COMMENT '日期(yyyy-MM-dd)',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uidx_unique_key` (`unique_key`) USING BTREE,
  KEY `idx_code_timestamp` (`code`, `timestamp`),
  KEY `idx_day` (`day`)
) ENGINE=InnoDB AUTO_INCREMENT=43136 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci COMMENT='股票日K线数据表';